<h1 class="index_title">Leagues</h1>

<table class= 'table'>
  <thead>
    <tr>
      <th>Name</th>
      <th>Entry fee</th>
      <th>Start date</th>
      <th>End date</th>
      <th>Rounds</th>
      <th>Players</th>
      <th>Exchanges</th>
      <th>Commissioner</th>
      <th></th>
    </tr>
  </thead>
  <tfoot>
    <tr>
      <th>Name</th>
      <th>Entry fee</th>
      <th>Start date</th>
      <th>End date</th>
      <th>Rounds</th>
      <th>Players</th>
      <th>Exchanges</th>
      <th>Commissioner</th>
      <th></th>
    </tr>
  </tfoot>

  <tbody>
    <% @leagues.each do |league| %>
      <tr>
        <td>
          <%=link_to league.name, league_path(league.id) %>
        </td>
        <td><%= league.entry_fee %></td>
        <td>
          <%= league.start_date.strftime("%m/%d/%y %I:%M%p").downcase %>
        </td>
        <td>
          <%= league.end_date.strftime("%m/%d/%y %I:%M%p").downcase %>
        </td>
        <td><%= league.rounds %></td>
        <td><%= league.users.count %></td>
        <td><%= league.exchanges.count %></td>
        <td>
            <%= link_to User.find(league.user_id).name,
                        user_path(User.find(league.user_id).id)%>
        </td>

        <td>
            <% unless current_user.leagues.any? { |l| l.id == league.id } %>
              <%= link_to "Join", join_path(league:league.id), method: :post,
                                            class: "button is-rounded is-small"
              %>
            <% end %>
        </td>
        <td><%= link_to 'Show', league %></td>
        <td><%= link_to 'Edit', edit_league_path(league) %></td>
        <td><%= link_to 'Destroy', league, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New League', new_league_path %>
